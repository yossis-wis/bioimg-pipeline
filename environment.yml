name: bioimg-pipeline
channels:
  - conda-forge

dependencies:
  # Core
  # If TensorFlow/StarDist wheels get fussy on your machine, try python=3.10.
  - python=3.11
  - pip=24.*
  # NOTE: TensorFlow 2.13's pip metadata pins typing-extensions<4.6, which can break
  # VS Code Jupyter / Spyder (TypeAliasType). We keep a modern typing-extensions here,
  # and if pip downgrades it during env creation/update, run:
  #   python scripts/fix_typing_extensions.py
  # or:
  #   python -m pip install -U "typing-extensions>=4.7"
  - typing-extensions>=4.7

  # Scientific stack (pin to a TensorFlow-compatible NumPy range)
  - numpy=1.24.3
  - scipy=1.10.*
  - pandas=2.0.*

  # I/O + configs
  - pyyaml=6.*
  - tifffile=2023.7.*
  - h5py=3.11.*
  - pyarrow=14.*

  # Image processing + plots
  - scikit-image=0.21.*
  - matplotlib=3.7.*

  # Dev / notebooks
  - ipykernel=6.*
  - jupyterlab=4.*
  - jupytext=1.*
  - pytest=8.*
  - ruff=0.7.*

  # Optional IDE (kept in the env so `conda env update --prune` doesn't remove it)
  - spyder=6.*
  - spyder-kernels=3.*

  # Slice1 (StarDist) lives on pip (TensorFlow wheels are most reliable via pip)
  - pip:
      - stardist==0.9.1
      - csbdeep==0.8.1
      - tensorflow==2.13.0
      - keras==2.13.1
